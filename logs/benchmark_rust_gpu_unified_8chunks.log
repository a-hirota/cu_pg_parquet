/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 64 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py:387: UserWarning: å›ºå®šé•·åˆ— lo_extendedprice ã®ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼å‡¦ç†ã«å¤±æ•—: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 237023488 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
  warnings.warn(f"å›ºå®šé•·åˆ— {col.name} ã®ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼å‡¦ç†ã«å¤±æ•—: {e}")
/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py:387: UserWarning: å›ºå®šé•·åˆ— lo_ordertotalprice ã®ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼å‡¦ç†ã«å¤±æ•—: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 237023488 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
  warnings.warn(f"å›ºå®šé•·åˆ— {col.name} ã®ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼å‡¦ç†ã«å¤±æ•—: {e}")
/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py:175: UserWarning: åˆ— lo_ordertotalprice ã®å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
  warnings.warn(f"åˆ— {col.name} ã®å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼: {e}")
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 360, in _create_fixed_series_zero_copy
    column_buffer = self._extract_column_zero_copy(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 401, in _extract_column_zero_copy
    column_buffer = cuda.device_array(rows * col_size, dtype=np.uint8)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devices.py", line 232, in _require_cuda_context
    return fn(*args, **kws)
           ^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/api.py", line 144, in device_array
    return devicearray.DeviceNDArray(shape=shape, strides=strides, dtype=dtype,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devicearray.py", line 103, in __init__
    gpu_data = devices.get_context().memalloc(self.alloc_size)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 1372, in memalloc
    return self.memory_manager.memalloc(bytesize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/rmm/allocators/numba.py", line 73, in memalloc
    buf = pylibrmm.DeviceBuffer(size=size)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "device_buffer.pyx", line 102, in rmm.pylibrmm.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 237023488 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 168, in create_cudf_from_gpu_buffers_zero_copy
    series = self._create_fixed_series_zero_copy(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 388, in _create_fixed_series_zero_copy
    return cudf.Series([None] * rows)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 147, in process_chunk_unified
    cudf_df, detailed_timing = postgresql_to_cudf_parquet(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 560, in postgresql_to_cudf_parquet
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 420, in process_postgresql_to_parquet
    cudf_df, decode_timing = self.decode_and_export(
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 357, in decode_and_export
    cudf_df = self.cudf_processor.create_cudf_from_gpu_buffers_zero_copy(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 177, in create_cudf_from_gpu_buffers_zero_copy
    cudf_series_dict[col.name] = cudf.Series([None] * rows)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 360, in _create_fixed_series_zero_copy
    column_buffer = self._extract_column_zero_copy(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 401, in _extract_column_zero_copy
    column_buffer = cuda.device_array(rows * col_size, dtype=np.uint8)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devices.py", line 232, in _require_cuda_context
    return fn(*args, **kws)
           ^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/api.py", line 144, in device_array
    return devicearray.DeviceNDArray(shape=shape, strides=strides, dtype=dtype,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devicearray.py", line 103, in __init__
    gpu_data = devices.get_context().memalloc(self.alloc_size)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 1372, in memalloc
    return self.memory_manager.memalloc(bytesize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/rmm/allocators/numba.py", line 73, in memalloc
    buf = pylibrmm.DeviceBuffer(size=size)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "device_buffer.pyx", line 102, in rmm.pylibrmm.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 237023488 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 168, in create_cudf_from_gpu_buffers_zero_copy
    series = self._create_fixed_series_zero_copy(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 388, in _create_fixed_series_zero_copy
    return cudf.Series([None] * rows)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 257, in main
    gpu_time, _, rows, timing = process_chunk_unified(chunk_info, columns)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 147, in process_chunk_unified
    cudf_df, detailed_timing = postgresql_to_cudf_parquet(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 560, in postgresql_to_cudf_parquet
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 420, in process_postgresql_to_parquet
    cudf_df, decode_timing = self.decode_and_export(
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 357, in decode_and_export
    cudf_df = self.cudf_processor.create_cudf_from_gpu_buffers_zero_copy(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 177, in create_cudf_from_gpu_buffers_zero_copy
    cudf_series_dict[col.name] = cudf.Series([None] * rows)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
=== PostgreSQL â†’ Rust â†’ GPU çµ±ä¸€å‡¦ç†ç‰ˆ ===
ãƒãƒ£ãƒ³ã‚¯æ•°: 8
å„ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: ç´„6.6 GB
å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: /dev/shm

æ”¹å–„å†…å®¹:
  - cuda.to_device()ã§ç›´æ¥GPUè»¢é€
  - postgresql_to_cudf_parquet()ã§ä¸€æ‹¬å‡¦ç†
  - cuDF DataFrameä½œæˆã®CPUã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰å•é¡Œã‚’è§£æ±º
RMMæ—¢ã«åˆæœŸåŒ–æ¸ˆã¿

âœ… CUDA context OK

[Rust] ãƒãƒ£ãƒ³ã‚¯ 1/8 è»¢é€é–‹å§‹
[Rust] ãƒãƒ£ãƒ³ã‚¯ 1 è»¢é€å®Œäº†: 6.59 GB, 4.87ç§’ (1.35 GB/ç§’)
ã‚«ãƒ©ãƒ æ•°: 17

[GPU] ãƒãƒ£ãƒ³ã‚¯ 1 çµ±ä¸€å‡¦ç†é–‹å§‹
  ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿: 3.65ç§’ (1.81 GB/ç§’)
  GPUè»¢é€: 0.54ç§’ (12.21 GB/ç§’)
=== GPUä¸¦åˆ—ãƒ‘ãƒ¼ã‚¹é–‹å§‹ ===
âœ… Ultra Fast GPUä¸¦åˆ—ãƒ‘ãƒ¼ã‚µãƒ¼ä½¿ç”¨ï¼ˆ8.94å€é«˜é€ŸåŒ–é”æˆï¼‰
GPUãƒ‘ãƒ¼ã‚¹å®Œäº†: 14813968 è¡Œ (3.0110ç§’)
=== æ–‡å­—åˆ—æœ€é©åŒ–ãƒ‡ã‚³ãƒ¼ãƒ‰é–‹å§‹ ===
æ–‡å­—åˆ—åˆ— lo_orderpriority: ç›´æ¥ã‚³ãƒ”ãƒ¼æœ€é©åŒ–ã‚«ãƒ¼ãƒãƒ«å®Ÿè¡Œ
âœ… æ–‡å­—åˆ—åˆ— lo_orderpriority: æœ€é©åŒ–ãƒãƒƒãƒ•ã‚¡ä½œæˆå®Œäº† (222209520 bytes)
æ–‡å­—åˆ—åˆ— lo_shippriority: ç›´æ¥ã‚³ãƒ”ãƒ¼æœ€é©åŒ–ã‚«ãƒ¼ãƒãƒ«å®Ÿè¡Œ
âœ… æ–‡å­—åˆ—åˆ— lo_shippriority: æœ€é©åŒ–ãƒãƒƒãƒ•ã‚¡ä½œæˆå®Œäº† (14813968 bytes)
æ–‡å­—åˆ—åˆ— lo_commit_date: ç›´æ¥ã‚³ãƒ”ãƒ¼æœ€é©åŒ–ã‚«ãƒ¼ãƒãƒ«å®Ÿè¡Œ
âœ… æ–‡å­—åˆ—åˆ— lo_commit_date: æœ€é©åŒ–ãƒãƒƒãƒ•ã‚¡ä½œæˆå®Œäº† (118511744 bytes)
æ–‡å­—åˆ—åˆ— lo_shipmode: ç›´æ¥ã‚³ãƒ”ãƒ¼æœ€é©åŒ–ã‚«ãƒ¼ãƒãƒ«å®Ÿè¡Œ
âœ… æ–‡å­—åˆ—åˆ— lo_shipmode: æœ€é©åŒ–ãƒãƒƒãƒ•ã‚¡ä½œæˆå®Œäº† (148139680 bytes)
çµ±åˆã‚«ãƒ¼ãƒãƒ«å®Ÿè¡Œï¼ˆå›ºå®šé•·ãƒ‡ãƒ¼ã‚¿ã®ã¿ï¼‰: 57868 blocks Ã— 256 threads
âŒ GPUå‡¦ç†ã‚¨ãƒ©ãƒ¼: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

âŒ ã‚¨ãƒ©ãƒ¼: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 360, in _create_fixed_series_zero_copy
    column_buffer = self._extract_column_zero_copy(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 401, in _extract_column_zero_copy
    column_buffer = cuda.device_array(rows * col_size, dtype=np.uint8)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devices.py", line 232, in _require_cuda_context
    return fn(*args, **kws)
           ^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/api.py", line 144, in device_array
    return devicearray.DeviceNDArray(shape=shape, strides=strides, dtype=dtype,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/devicearray.py", line 103, in __init__
    gpu_data = devices.get_context().memalloc(self.alloc_size)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 1372, in memalloc
    return self.memory_manager.memalloc(bytesize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/rmm/allocators/numba.py", line 73, in memalloc
    buf = pylibrmm.DeviceBuffer(size=size)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "device_buffer.pyx", line 102, in rmm.pylibrmm.device_buffer.DeviceBuffer.__cinit__
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 237023488 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 168, in create_cudf_from_gpu_buffers_zero_copy
    series = self._create_fixed_series_zero_copy(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 388, in _create_fixed_series_zero_copy
    return cudf.Series([None] * rows)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 292, in <module>
    main()
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 257, in main
    gpu_time, _, rows, timing = process_chunk_unified(chunk_info, columns)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_unified.py", line 147, in process_chunk_unified
    cudf_df, detailed_timing = postgresql_to_cudf_parquet(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 560, in postgresql_to_cudf_parquet
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 420, in process_postgresql_to_parquet
    cudf_df, decode_timing = self.decode_and_export(
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet.py", line 357, in decode_and_export
    cudf_df = self.cudf_processor.create_cudf_from_gpu_buffers_zero_copy(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/build_cudf_from_buf.py", line 177, in create_cudf_from_gpu_buffers_zero_copy
    cudf_series_dict[col.name] = cudf.Series([None] * rows)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/utils/performance_tracking.py", line 51, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/series.py", line 683, in __init__
    column = as_column(
             ^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 3005, in as_column
    return as_column(arbitrary, nan_as_null=nan_as_null, dtype=dtype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 2597, in as_column
    col = col.astype(dtype)
          ^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/column.py", line 1638, in astype
    result = self.as_string_column()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/cudf/core/column/numerical.py", line 358, in as_string_column
    conv_func(self.to_pylibcudf(mode="read"))
  File "convert_integers.pyx", line 54, in pylibcudf.strings.convert.convert_integers.from_integers
  File "convert_integers.pyx", line 75, in pylibcudf.strings.convert.convert_integers.from_integers
MemoryError: std::bad_alloc: out_of_memory: CUDA error (failed to allocate 59255888 bytes) at: /home/ubuntu/miniconda3/envs/cudf_dev/include/rmm/mr/device/cuda_memory_resource.hpp
