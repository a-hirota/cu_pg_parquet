/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py:605: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
  warn(NumbaPerformanceWarning(msg))
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 157, in process_chunk_direct
    cudf_df, detailed_timing = postgresql_to_cudf_parquet_direct(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 338, in postgresql_to_cudf_parquet_direct
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 210, in process_postgresql_to_parquet
    field_offsets_dev, field_lengths_dev = parse_binary_chunk_gpu_ultra_fast_v2(
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 415, in parse_binary_chunk_gpu_ultra_fast_v2
    return parse_binary_chunk_gpu_ultra_fast_v2_lite(raw_dev, columns, header_size, debug)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 362, in parse_binary_chunk_gpu_ultra_fast_v2_lite
    parse_rows_and_fields_lite[grid_2d, threads_per_block](
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 608, in __call__
    return self.dispatcher.call(args, self.griddim, self.blockdim,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 752, in call
    kernel.launch(args, griddim, blockdim, stream, sharedmem)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 394, in launch
    driver.launch_kernel(cufunc.handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 2563, in launch_kernel
    driver.cuLaunchKernel(cufunc_handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 327, in safe_cuda_api_call
    self._check_ctypes_error(fname, retcode)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 395, in _check_ctypes_error
    raise CudaAPIError(retcode, msg)
numba.cuda.cudadrv.driver.CudaAPIError: [2] Call to cuLaunchKernel results in CUDA_ERROR_OUT_OF_MEMORY
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 281, in main
    gpu_time, _, rows, timing = process_chunk_direct(chunk_info, columns)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 157, in process_chunk_direct
    cudf_df, detailed_timing = postgresql_to_cudf_parquet_direct(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 338, in postgresql_to_cudf_parquet_direct
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 210, in process_postgresql_to_parquet
    field_offsets_dev, field_lengths_dev = parse_binary_chunk_gpu_ultra_fast_v2(
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 415, in parse_binary_chunk_gpu_ultra_fast_v2
    return parse_binary_chunk_gpu_ultra_fast_v2_lite(raw_dev, columns, header_size, debug)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 362, in parse_binary_chunk_gpu_ultra_fast_v2_lite
    parse_rows_and_fields_lite[grid_2d, threads_per_block](
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 608, in __call__
    return self.dispatcher.call(args, self.griddim, self.blockdim,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 752, in call
    kernel.launch(args, griddim, blockdim, stream, sharedmem)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 394, in launch
    driver.launch_kernel(cufunc.handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 2563, in launch_kernel
    driver.cuLaunchKernel(cufunc_handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 327, in safe_cuda_api_call
    self._check_ctypes_error(fname, retcode)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 395, in _check_ctypes_error
    raise CudaAPIError(retcode, msg)
numba.cuda.cudadrv.driver.CudaAPIError: [2] Call to cuLaunchKernel results in CUDA_ERROR_OUT_OF_MEMORY
=== PostgreSQL â†’ Rust â†’ GPU ç›´æ¥æŠ½å‡ºç‰ˆï¼ˆçµ±åˆãƒãƒƒãƒ•ã‚¡å‰Šé™¤ï¼‰ ===
ãƒãƒ£ãƒ³ã‚¯æ•°: 4
å„ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: ç´„13.2 GB
å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: /dev/shm

æ”¹å–„å†…å®¹:
  - çµ±åˆãƒãƒƒãƒ•ã‚¡ã‚’å®Œå…¨ã«å‰Šé™¤
  - RMM DeviceBufferã§å…¨ã¦ã®åˆ—ã‚’å‡¦ç†
  - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å¤§å¹…å‰Šæ¸›
  - ãƒãƒ£ãƒ³ã‚¯æ•°ã‚’4ã«å‰Šæ¸›ï¼ˆå„ç´„13.2GBï¼‰
RMMæ—¢ã«åˆæœŸåŒ–æ¸ˆã¿

âœ… CUDA context OK

[Rust] ãƒãƒ£ãƒ³ã‚¯ 1/4 è»¢é€é–‹å§‹
[Rust] ãƒãƒ£ãƒ³ã‚¯ 1 è»¢é€å®Œäº†: 13.08 GB, 9.15ç§’ (1.43 GB/ç§’)
ã‚«ãƒ©ãƒ æ•°: 17

[GPU] ãƒãƒ£ãƒ³ã‚¯ 1 ç›´æ¥æŠ½å‡ºå‡¦ç†é–‹å§‹ï¼ˆçµ±åˆãƒãƒƒãƒ•ã‚¡å‰Šé™¤ï¼‰
  ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿: 7.21ç§’ (1.81 GB/ç§’)
  GPUè»¢é€: 1.49ç§’ (8.78 GB/ç§’)
=== GPUä¸¦åˆ—ãƒ‘ãƒ¼ã‚¹é–‹å§‹ ===
âŒ GPUå‡¦ç†ã‚¨ãƒ©ãƒ¼: [2] Call to cuLaunchKernel results in CUDA_ERROR_OUT_OF_MEMORY

âŒ ã‚¨ãƒ©ãƒ¼: [2] Call to cuLaunchKernel results in CUDA_ERROR_OUT_OF_MEMORY
Traceback (most recent call last):
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 407, in <module>
    main()
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 281, in main
    gpu_time, _, rows, timing = process_chunk_direct(chunk_info, columns)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/benchmark/benchmark_rust_gpu_direct.py", line 157, in process_chunk_direct
    cudf_df, detailed_timing = postgresql_to_cudf_parquet_direct(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 338, in postgresql_to_cudf_parquet_direct
    return processor.process_postgresql_to_parquet(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/main_postgres_to_parquet_direct.py", line 210, in process_postgresql_to_parquet
    field_offsets_dev, field_lengths_dev = parse_binary_chunk_gpu_ultra_fast_v2(
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 415, in parse_binary_chunk_gpu_ultra_fast_v2
    return parse_binary_chunk_gpu_ultra_fast_v2_lite(raw_dev, columns, header_size, debug)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/gpupgparser/src/cuda_kernels/postgres_binary_parser.py", line 362, in parse_binary_chunk_gpu_ultra_fast_v2_lite
    parse_rows_and_fields_lite[grid_2d, threads_per_block](
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 608, in __call__
    return self.dispatcher.call(args, self.griddim, self.blockdim,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 752, in call
    kernel.launch(args, griddim, blockdim, stream, sharedmem)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/dispatcher.py", line 394, in launch
    driver.launch_kernel(cufunc.handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 2563, in launch_kernel
    driver.cuLaunchKernel(cufunc_handle,
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 327, in safe_cuda_api_call
    self._check_ctypes_error(fname, retcode)
  File "/home/ubuntu/miniconda3/envs/cudf_dev/lib/python3.12/site-packages/numba_cuda/numba/cuda/cudadrv/driver.py", line 395, in _check_ctypes_error
    raise CudaAPIError(retcode, msg)
numba.cuda.cudadrv.driver.CudaAPIError: [2] Call to cuLaunchKernel results in CUDA_ERROR_OUT_OF_MEMORY
