# 15行欠落問題の原因判明

## 発見した事実

1. **256MB境界でのスレッドスキップ**
   - Thread 1398101（0x0FFFFFD3）で終了
   - Thread 3404032（0x26F4C013）で再開
   - 約200万スレッド（385MB）がスキップされる

2. **ビット28の変化**
   - 256MB境界（0x10000000）でビット28が0→1に変化
   - GPUカーネルがこの変化を正しく処理できていない可能性

3. **実際のデータ分布**
   - Worker 2が256MB境界を含む（202.2MB - 303.3MB）
   - スキップ範囲（256MB - 623MB）はWorker 3-5の領域
   - これらのワーカーは実際にはデータを持っていない（またはごく少量）

## 結論

**15行の欠落は、256MB境界でGPUカーネルが200万スレッドをスキップし、その境界付近にあった15行のデータが処理されなかったため。**

## 解決策

1. GPUカーネルのアドレス計算を修正（ビット28の扱い）
2. または、256MB境界を避けるようにスレッド配置を調整
3. または、境界付近の特別処理を追加